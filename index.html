<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>中文文本翻译器</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }
        .section {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            resize: vertical;
            min-height: 100px;
        }
        .button-group {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }
        button {
            flex: 1;
            padding: 10px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .btn-encrypt {
            background-color: #4CAF50;
            color: white;
        }
        .btn-decrypt {
            background-color: #2196F3;
            color: white;
        }
        .btn-clear {
            background-color: #f44336;
            color: white;
        }
        .btn-settings {
            background-color: #FF9800;
            color: white;
            margin-bottom: 10px;
        }
        .btn-save {
            background-color: #4CAF50;
            color: white;
        }
        .btn-copy {
            background-color: #9C27B0;
            color: white;
            flex: 0.5;
        }
        .btn-copy:hover {
            opacity: 0.9;
        }
        .btn-copy-success {
            background-color: #4CAF50;
            color: white;
            flex: 0.5;
        }
        button:hover {
            opacity: 0.9;
        }
        .info {
            text-align: center;
            color: #666;
            font-size: 14px;
            margin-top: 20px;
        }
        .settings-panel {
            display: none;
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
        }
        .char-input {
            display: flex;
            gap: 10px;
            margin: 10px 0;
        }
        .char-input input {
            flex: 1;
            padding: 8px;
            font-size: 18px;
            text-align: center;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .current-chars {
            text-align: center;
            font-size: 18px;
            color: #333;
            margin: 10px 0;
            font-weight: bold;
        }
        .error {
            color: #f44336;
            font-size: 14px;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>中文文本翻译器</h1>
        
        <button class="btn-settings" onclick="toggleSettings()">⚙️ 设置自定义字符</button>
        
        <div id="settingsPanel" class="settings-panel">
            <label>自定义十六个固定字符：</label>
            <div class="current-chars" id="currentChars">当前字符：天地玄黄宇宙洪荒日月星辰山川河海</div>
            <div class="char-input" style="flex-wrap: wrap;">
                <input type="text" id="char1" maxlength="1" placeholder="1">
                <input type="text" id="char2" maxlength="1" placeholder="2">
                <input type="text" id="char3" maxlength="1" placeholder="3">
                <input type="text" id="char4" maxlength="1" placeholder="4">
                <input type="text" id="char5" maxlength="1" placeholder="5">
                <input type="text" id="char6" maxlength="1" placeholder="6">
                <input type="text" id="char7" maxlength="1" placeholder="7">
                <input type="text" id="char8" maxlength="1" placeholder="8">
                <input type="text" id="char9" maxlength="1" placeholder="9">
                <input type="text" id="char10" maxlength="1" placeholder="10">
                <input type="text" id="char11" maxlength="1" placeholder="11">
                <input type="text" id="char12" maxlength="1" placeholder="12">
                <input type="text" id="char13" maxlength="1" placeholder="13">
                <input type="text" id="char14" maxlength="1" placeholder="14">
                <input type="text" id="char15" maxlength="1" placeholder="15">
                <input type="text" id="char16" maxlength="1" placeholder="16">
            </div>
            <div id="settingsError" class="error" style="display: none;"></div>
            <div class="button-group">
                <button class="btn-save" onclick="saveCustomChars()">保存设置</button>
                <button class="btn-clear" onclick="resetToDefault()">恢复默认</button>
            </div>
        </div>

        <div class="section">
            <label for="plainText">明文：</label>
            <textarea id="plainText" placeholder="请输入要转换的明文..."></textarea>
            <div class="button-group">
                <button class="btn-encrypt" onclick="encryptText()">明文 → 暗文</button>
                <button class="btn-clear" onclick="clearPlain()">清空</button>
            </div>
        </div>

        <div class="section">
            <label for="cipherText">暗文：</label>
            <textarea id="cipherText" placeholder="暗文将显示在这里..." readonly></textarea>
            <div class="button-group">
                <button class="btn-copy" onclick="copyToClipboard('cipherText')">📋 复制</button>
            </div>
        </div>

        <div class="section">
            <label for="decryptInput">暗文输入：</label>
            <textarea id="decryptInput" placeholder="请输入要解密的暗文..."></textarea>
            <div class="button-group">
                <button class="btn-decrypt" onclick="decryptText()">暗文 → 明文</button>
                <button class="btn-clear" onclick="clearCipher()">清空</button>
            </div>
        </div>

        <div class="section">
            <label for="decryptedText">解密结果：</label>
            <textarea id="decryptedText" placeholder="原始明文将显示在这里..." readonly></textarea>
            <div class="button-group">
                <button class="btn-copy" onclick="copyToClipboard('decryptedText')">📋 复制</button>
            </div>
        </div>

        <div class="info" id="charInfo">
            提示：暗文由"天地玄黄宇"五个固定文字的不同排列组合而成
        </div>
    </div>

    <script>
        // 默认的十六个固定文字（16进制需要16个字符）
        const defaultChars = ['天', '地', '玄', '黄', '宇', '宙', '洪', '荒', '日', '月', '星', '辰', '山', '川', '河', '海'];
        let cipherChars = [...defaultChars];
        
        // 创建字符到数字的映射
        let charToNum = {};
        let numToChar = {};
        
        // 初始化映射表
        function initMappings() {
            charToNum = {};
            numToChar = {};
            for (let i = 0; i < cipherChars.length; i++) {
                charToNum[cipherChars[i]] = i;
                numToChar[i] = cipherChars[i];
            }
            document.getElementById('currentChars').textContent = '当前字符：' + cipherChars.join('');
            document.getElementById('charInfo').textContent = '提示：暗文由"' + cipherChars.join('') + '"十六个固定文字组成';
        }
        
        // 页面加载时初始化
        initMappings();
        
        // 切换设置面板
        function toggleSettings() {
            const panel = document.getElementById('settingsPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }
        
        // 保存自定义字符
        function saveCustomChars() {
            const chars = [];
            const inputs = [
                document.getElementById('char1').value.trim(),
                document.getElementById('char2').value.trim(),
                document.getElementById('char3').value.trim(),
                document.getElementById('char4').value.trim(),
                document.getElementById('char5').value.trim(),
                document.getElementById('char6').value.trim(),
                document.getElementById('char7').value.trim(),
                document.getElementById('char8').value.trim(),
                document.getElementById('char9').value.trim(),
                document.getElementById('char10').value.trim(),
                document.getElementById('char11').value.trim(),
                document.getElementById('char12').value.trim(),
                document.getElementById('char13').value.trim(),
                document.getElementById('char14').value.trim(),
                document.getElementById('char15').value.trim(),
                document.getElementById('char16').value.trim()
            ];
            
            const errorDiv = document.getElementById('settingsError');
            
            // 验证输入
            for (let i = 0; i < inputs.length; i++) {
                if (!inputs[i]) {
                    errorDiv.textContent = `第${i+1}个字符不能为空！`;
                    errorDiv.style.display = 'block';
                    return;
                }
                if (chars.includes(inputs[i])) {
                    errorDiv.textContent = '字符不能重复！';
                    errorDiv.style.display = 'block';
                    return;
                }
                chars.push(inputs[i]);
            }
            
            // 保存设置
            cipherChars = chars;
            initMappings();
            
            // 清空输入框
            for (let i = 1; i <= 16; i++) {
                document.getElementById(`char${i}`).value = '';
            }
            
            errorDiv.style.display = 'none';
            alert('自定义字符设置已保存！');
        }
        
        // 恢复默认设置
        function resetToDefault() {
            cipherChars = [...defaultChars];
            initMappings();
            
            // 清空输入框
            for (let i = 1; i <= 16; i++) {
                document.getElementById(`char${i}`).value = '';
            }
            
            alert('已恢复默认字符：天地玄黄宇宙洪荒日月星辰山川河海');
        }
        
        // 明文转暗文
        function encryptText() {
            const plainText = document.getElementById('plainText').value;
            if (!plainText.trim()) {
                alert('请输入明文！');
                return;
            }
            
            let cipherText = '';
            
            // 将每个字符转换为暗文
            for (let i = 0; i < plainText.length; i++) {
                const char = plainText[i];
                const charCode = char.charCodeAt(0);
                
                // 将字符编码转换为暗文表示
                const encrypted = encryptChar(charCode);
                cipherText += encrypted + ' ';
            }
            
            document.getElementById('cipherText').value = cipherText.trim();
        }
        
        // 单个字符加密（16进制）
        function encryptChar(charCode) {
            let result = '';
            let num = charCode;
            
            // 使用16进制表示，每个数字对应一个暗文字符
            while (num > 0) {
                const remainder = num % 16;
                result = numToChar[remainder] + result;
                num = Math.floor(num / 16);
            }
            
            // 确保至少有一个字符
            if (result === '') {
                result = numToChar[0];
            }
            
            return result;
        }
        
        // 暗文转明文
        function decryptText() {
            const cipherText = document.getElementById('decryptInput').value;
            if (!cipherText.trim()) {
                alert('请输入暗文！');
                return;
            }
            
            const cipherWords = cipherText.trim().split(/\s+/);
            let plainText = '';
            
            try {
                for (let word of cipherWords) {
                    const decrypted = decryptWord(word);
                    plainText += String.fromCharCode(decrypted);
                }
                
                document.getElementById('decryptedText').value = plainText;
            } catch (e) {
                alert(`暗文格式错误！请确保只包含"${cipherChars.join('')}"十六个字`);
            }
        }
        
        // 单个暗文字解密（16进制）
        function decryptWord(word) {
            let result = 0;
            
            for (let char of word) {
                if (!(char in charToNum)) {
                    throw new Error('Invalid cipher character');
                }
                result = result * 16 + charToNum[char];
            }
            
            return result;
        }
        
        // 清空明文区域
        function clearPlain() {
            document.getElementById('plainText').value = '';
            document.getElementById('cipherText').value = '';
        }
        
        // 清空暗文区域
        function clearCipher() {
            document.getElementById('decryptInput').value = '';
            document.getElementById('decryptedText').value = '';
        }
        
        // 复制到剪贴板
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            const button = event.target;
            const originalText = button.innerHTML;
            
            // 选择文本并复制
            element.select();
            element.setSelectionRange(0, 99999); // 移动设备兼容
            
            try {
                navigator.clipboard.writeText(element.value).then(() => {
                    // 成功反馈
                    button.innerHTML = '✅ 已复制';
                    button.className = 'btn-copy-success';
                    
                    // 2秒后恢复原状
                    setTimeout(() => {
                        button.innerHTML = originalText;
                        button.className = 'btn-copy';
                    }, 2000);
                }).catch(err => {
                    // 备用方案
                    document.execCommand('copy');
                    button.innerHTML = '✅ 已复制';
                    button.className = 'btn-copy-success';
                    
                    setTimeout(() => {
                        button.innerHTML = originalText;
                        button.className = 'btn-copy';
                    }, 2000);
                });
            } catch (err) {
                alert('复制失败，请手动选择复制');
            }
        }
        
        // 允许按Enter键快速转换
        document.getElementById('plainText').addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                encryptText();
            }
        });
        
        document.getElementById('decryptInput').addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                decryptText();
            }
        });
    </script>
</body>
</html>