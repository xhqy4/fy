<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸­æ–‡æ–‡æœ¬ç¿»è¯‘å™¨</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }
        .section {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            resize: vertical;
            min-height: 100px;
        }
        .button-group {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }
        button {
            flex: 1;
            padding: 10px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .btn-encrypt {
            background-color: #4CAF50;
            color: white;
        }
        .btn-decrypt {
            background-color: #2196F3;
            color: white;
        }
        .btn-clear {
            background-color: #f44336;
            color: white;
        }
        .btn-settings {
            background-color: #FF9800;
            color: white;
            margin-bottom: 10px;
        }
        .btn-save {
            background-color: #4CAF50;
            color: white;
        }
        .btn-copy {
            background-color: #9C27B0;
            color: white;
            flex: 0.5;
        }
        .btn-copy:hover {
            opacity: 0.9;
        }
        .btn-copy-success {
            background-color: #4CAF50;
            color: white;
            flex: 0.5;
        }
        button:hover {
            opacity: 0.9;
        }
        .info {
            text-align: center;
            color: #666;
            font-size: 14px;
            margin-top: 20px;
        }
        .settings-panel {
            display: none;
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
        }
        .char-input {
            display: flex;
            gap: 10px;
            margin: 10px 0;
        }
        .char-input input {
            flex: 1;
            padding: 8px;
            font-size: 18px;
            text-align: center;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .current-chars {
            text-align: center;
            font-size: 18px;
            color: #333;
            margin: 10px 0;
            font-weight: bold;
        }
        .error {
            color: #f44336;
            font-size: 14px;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ä¸­æ–‡æ–‡æœ¬ç¿»è¯‘å™¨</h1>
        
        <button class="btn-settings" onclick="toggleSettings()">âš™ï¸ è®¾ç½®è‡ªå®šä¹‰å­—ç¬¦</button>
        
        <div id="settingsPanel" class="settings-panel">
            <label>è‡ªå®šä¹‰åå…­ä¸ªå›ºå®šå­—ç¬¦ï¼š</label>
            <div class="current-chars" id="currentChars">å½“å‰å­—ç¬¦ï¼šå¤©åœ°ç„é»„å®‡å®™æ´ªè’æ—¥æœˆæ˜Ÿè¾°å±±å·æ²³æµ·</div>
            <div class="char-input" style="flex-wrap: wrap;">
                <input type="text" id="char1" maxlength="1" placeholder="1">
                <input type="text" id="char2" maxlength="1" placeholder="2">
                <input type="text" id="char3" maxlength="1" placeholder="3">
                <input type="text" id="char4" maxlength="1" placeholder="4">
                <input type="text" id="char5" maxlength="1" placeholder="5">
                <input type="text" id="char6" maxlength="1" placeholder="6">
                <input type="text" id="char7" maxlength="1" placeholder="7">
                <input type="text" id="char8" maxlength="1" placeholder="8">
                <input type="text" id="char9" maxlength="1" placeholder="9">
                <input type="text" id="char10" maxlength="1" placeholder="10">
                <input type="text" id="char11" maxlength="1" placeholder="11">
                <input type="text" id="char12" maxlength="1" placeholder="12">
                <input type="text" id="char13" maxlength="1" placeholder="13">
                <input type="text" id="char14" maxlength="1" placeholder="14">
                <input type="text" id="char15" maxlength="1" placeholder="15">
                <input type="text" id="char16" maxlength="1" placeholder="16">
            </div>
            <div id="settingsError" class="error" style="display: none;"></div>
            <div class="button-group">
                <button class="btn-save" onclick="saveCustomChars()">ä¿å­˜è®¾ç½®</button>
                <button class="btn-clear" onclick="resetToDefault()">æ¢å¤é»˜è®¤</button>
            </div>
        </div>

        <div class="section">
            <label for="plainText">æ˜æ–‡ï¼š</label>
            <textarea id="plainText" placeholder="è¯·è¾“å…¥è¦è½¬æ¢çš„æ˜æ–‡..."></textarea>
            <div class="button-group">
                <button class="btn-encrypt" onclick="encryptText()">æ˜æ–‡ â†’ æš—æ–‡</button>
                <button class="btn-clear" onclick="clearPlain()">æ¸…ç©º</button>
            </div>
        </div>

        <div class="section">
            <label for="cipherText">æš—æ–‡ï¼š</label>
            <textarea id="cipherText" placeholder="æš—æ–‡å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..." readonly></textarea>
            <div class="button-group">
                <button class="btn-copy" onclick="copyToClipboard('cipherText')">ğŸ“‹ å¤åˆ¶</button>
            </div>
        </div>

        <div class="section">
            <label for="decryptInput">æš—æ–‡è¾“å…¥ï¼š</label>
            <textarea id="decryptInput" placeholder="è¯·è¾“å…¥è¦è§£å¯†çš„æš—æ–‡..."></textarea>
            <div class="button-group">
                <button class="btn-decrypt" onclick="decryptText()">æš—æ–‡ â†’ æ˜æ–‡</button>
                <button class="btn-clear" onclick="clearCipher()">æ¸…ç©º</button>
            </div>
        </div>

        <div class="section">
            <label for="decryptedText">è§£å¯†ç»“æœï¼š</label>
            <textarea id="decryptedText" placeholder="åŸå§‹æ˜æ–‡å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..." readonly></textarea>
            <div class="button-group">
                <button class="btn-copy" onclick="copyToClipboard('decryptedText')">ğŸ“‹ å¤åˆ¶</button>
            </div>
        </div>

        <div class="info" id="charInfo">
            æç¤ºï¼šæš—æ–‡ç”±"å¤©åœ°ç„é»„å®‡"äº”ä¸ªå›ºå®šæ–‡å­—çš„ä¸åŒæ’åˆ—ç»„åˆè€Œæˆ
        </div>
    </div>

    <script>
        // é»˜è®¤çš„åå…­ä¸ªå›ºå®šæ–‡å­—ï¼ˆ16è¿›åˆ¶éœ€è¦16ä¸ªå­—ç¬¦ï¼‰
        const defaultChars = ['å¤©', 'åœ°', 'ç„', 'é»„', 'å®‡', 'å®™', 'æ´ª', 'è’', 'æ—¥', 'æœˆ', 'æ˜Ÿ', 'è¾°', 'å±±', 'å·', 'æ²³', 'æµ·'];
        let cipherChars = [...defaultChars];
        
        // åˆ›å»ºå­—ç¬¦åˆ°æ•°å­—çš„æ˜ å°„
        let charToNum = {};
        let numToChar = {};
        
        // åˆå§‹åŒ–æ˜ å°„è¡¨
        function initMappings() {
            charToNum = {};
            numToChar = {};
            for (let i = 0; i < cipherChars.length; i++) {
                charToNum[cipherChars[i]] = i;
                numToChar[i] = cipherChars[i];
            }
            document.getElementById('currentChars').textContent = 'å½“å‰å­—ç¬¦ï¼š' + cipherChars.join('');
            document.getElementById('charInfo').textContent = 'æç¤ºï¼šæš—æ–‡ç”±"' + cipherChars.join('') + '"åå…­ä¸ªå›ºå®šæ–‡å­—ç»„æˆ';
        }
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        initMappings();
        
        // åˆ‡æ¢è®¾ç½®é¢æ¿
        function toggleSettings() {
            const panel = document.getElementById('settingsPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }
        
        // ä¿å­˜è‡ªå®šä¹‰å­—ç¬¦
        function saveCustomChars() {
            const chars = [];
            const inputs = [
                document.getElementById('char1').value.trim(),
                document.getElementById('char2').value.trim(),
                document.getElementById('char3').value.trim(),
                document.getElementById('char4').value.trim(),
                document.getElementById('char5').value.trim(),
                document.getElementById('char6').value.trim(),
                document.getElementById('char7').value.trim(),
                document.getElementById('char8').value.trim(),
                document.getElementById('char9').value.trim(),
                document.getElementById('char10').value.trim(),
                document.getElementById('char11').value.trim(),
                document.getElementById('char12').value.trim(),
                document.getElementById('char13').value.trim(),
                document.getElementById('char14').value.trim(),
                document.getElementById('char15').value.trim(),
                document.getElementById('char16').value.trim()
            ];
            
            const errorDiv = document.getElementById('settingsError');
            
            // éªŒè¯è¾“å…¥
            for (let i = 0; i < inputs.length; i++) {
                if (!inputs[i]) {
                    errorDiv.textContent = `ç¬¬${i+1}ä¸ªå­—ç¬¦ä¸èƒ½ä¸ºç©ºï¼`;
                    errorDiv.style.display = 'block';
                    return;
                }
                if (chars.includes(inputs[i])) {
                    errorDiv.textContent = 'å­—ç¬¦ä¸èƒ½é‡å¤ï¼';
                    errorDiv.style.display = 'block';
                    return;
                }
                chars.push(inputs[i]);
            }
            
            // ä¿å­˜è®¾ç½®
            cipherChars = chars;
            initMappings();
            
            // æ¸…ç©ºè¾“å…¥æ¡†
            for (let i = 1; i <= 16; i++) {
                document.getElementById(`char${i}`).value = '';
            }
            
            errorDiv.style.display = 'none';
            alert('è‡ªå®šä¹‰å­—ç¬¦è®¾ç½®å·²ä¿å­˜ï¼');
        }
        
        // æ¢å¤é»˜è®¤è®¾ç½®
        function resetToDefault() {
            cipherChars = [...defaultChars];
            initMappings();
            
            // æ¸…ç©ºè¾“å…¥æ¡†
            for (let i = 1; i <= 16; i++) {
                document.getElementById(`char${i}`).value = '';
            }
            
            alert('å·²æ¢å¤é»˜è®¤å­—ç¬¦ï¼šå¤©åœ°ç„é»„å®‡å®™æ´ªè’æ—¥æœˆæ˜Ÿè¾°å±±å·æ²³æµ·');
        }
        
        // æ˜æ–‡è½¬æš—æ–‡
        function encryptText() {
            const plainText = document.getElementById('plainText').value;
            if (!plainText.trim()) {
                alert('è¯·è¾“å…¥æ˜æ–‡ï¼');
                return;
            }
            
            let cipherText = '';
            
            // å°†æ¯ä¸ªå­—ç¬¦è½¬æ¢ä¸ºæš—æ–‡
            for (let i = 0; i < plainText.length; i++) {
                const char = plainText[i];
                const charCode = char.charCodeAt(0);
                
                // å°†å­—ç¬¦ç¼–ç è½¬æ¢ä¸ºæš—æ–‡è¡¨ç¤º
                const encrypted = encryptChar(charCode);
                cipherText += encrypted + ' ';
            }
            
            document.getElementById('cipherText').value = cipherText.trim();
        }
        
        // å•ä¸ªå­—ç¬¦åŠ å¯†ï¼ˆ16è¿›åˆ¶ï¼‰
        function encryptChar(charCode) {
            let result = '';
            let num = charCode;
            
            // ä½¿ç”¨16è¿›åˆ¶è¡¨ç¤ºï¼Œæ¯ä¸ªæ•°å­—å¯¹åº”ä¸€ä¸ªæš—æ–‡å­—ç¬¦
            while (num > 0) {
                const remainder = num % 16;
                result = numToChar[remainder] + result;
                num = Math.floor(num / 16);
            }
            
            // ç¡®ä¿è‡³å°‘æœ‰ä¸€ä¸ªå­—ç¬¦
            if (result === '') {
                result = numToChar[0];
            }
            
            return result;
        }
        
        // æš—æ–‡è½¬æ˜æ–‡
        function decryptText() {
            const cipherText = document.getElementById('decryptInput').value;
            if (!cipherText.trim()) {
                alert('è¯·è¾“å…¥æš—æ–‡ï¼');
                return;
            }
            
            const cipherWords = cipherText.trim().split(/\s+/);
            let plainText = '';
            
            try {
                for (let word of cipherWords) {
                    const decrypted = decryptWord(word);
                    plainText += String.fromCharCode(decrypted);
                }
                
                document.getElementById('decryptedText').value = plainText;
            } catch (e) {
                alert(`æš—æ–‡æ ¼å¼é”™è¯¯ï¼è¯·ç¡®ä¿åªåŒ…å«"${cipherChars.join('')}"åå…­ä¸ªå­—`);
            }
        }
        
        // å•ä¸ªæš—æ–‡å­—è§£å¯†ï¼ˆ16è¿›åˆ¶ï¼‰
        function decryptWord(word) {
            let result = 0;
            
            for (let char of word) {
                if (!(char in charToNum)) {
                    throw new Error('Invalid cipher character');
                }
                result = result * 16 + charToNum[char];
            }
            
            return result;
        }
        
        // æ¸…ç©ºæ˜æ–‡åŒºåŸŸ
        function clearPlain() {
            document.getElementById('plainText').value = '';
            document.getElementById('cipherText').value = '';
        }
        
        // æ¸…ç©ºæš—æ–‡åŒºåŸŸ
        function clearCipher() {
            document.getElementById('decryptInput').value = '';
            document.getElementById('decryptedText').value = '';
        }
        
        // å¤åˆ¶åˆ°å‰ªè´´æ¿
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            const button = event.target;
            const originalText = button.innerHTML;
            
            // é€‰æ‹©æ–‡æœ¬å¹¶å¤åˆ¶
            element.select();
            element.setSelectionRange(0, 99999); // ç§»åŠ¨è®¾å¤‡å…¼å®¹
            
            try {
                navigator.clipboard.writeText(element.value).then(() => {
                    // æˆåŠŸåé¦ˆ
                    button.innerHTML = 'âœ… å·²å¤åˆ¶';
                    button.className = 'btn-copy-success';
                    
                    // 2ç§’åæ¢å¤åŸçŠ¶
                    setTimeout(() => {
                        button.innerHTML = originalText;
                        button.className = 'btn-copy';
                    }, 2000);
                }).catch(err => {
                    // å¤‡ç”¨æ–¹æ¡ˆ
                    document.execCommand('copy');
                    button.innerHTML = 'âœ… å·²å¤åˆ¶';
                    button.className = 'btn-copy-success';
                    
                    setTimeout(() => {
                        button.innerHTML = originalText;
                        button.className = 'btn-copy';
                    }, 2000);
                });
            } catch (err) {
                alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©å¤åˆ¶');
            }
        }
        
        // å…è®¸æŒ‰Enteré”®å¿«é€Ÿè½¬æ¢
        document.getElementById('plainText').addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                encryptText();
            }
        });
        
        document.getElementById('decryptInput').addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                decryptText();
            }
        });
    </script>
</body>
</html>